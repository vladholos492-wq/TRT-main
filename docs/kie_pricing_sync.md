# ๐ KIE.AI PRICING SYNC

## ะัะพะฑะปะตะผะฐ

ะะพัะปะต ะฟะตัะฒะธัะฝะพะณะพ ะฐัะดะธัะฐ ะฑัะปะพ ะพะฑะฝะฐััะถะตะฝะพ:
- **89 AI ะผะพะดะตะปะตะน** ั ัะตะฝะฐะผะธ ะฒ registry
- **66 ะผะพะดะตะปะตะน (74%)** ะฟะพะผะตัะตะฝั ะบะฐะบ `disabled_reason: "ะฆะตะฝะฐ ะฝะต ะฟะพะดัะฒะตัะถะดะตะฝะฐ ะฟัะพะฒะฐะนะดะตัะพะผ"`
- ะะพะดะตะปะธ ะฑัะปะธ **ะกะะะซะขะซ** ะพั ะฟะพะปัะทะพะฒะฐัะตะปะตะน

## ะะตัะตะฝะธะต

### 1๏ธโฃ ะะซะกะขะะะ: ะะบะปััะตะฝะธะต ะฒัะตั ะผะพะดะตะปะตะน ั ะฟัะตะดัะฟัะตะถะดะตะฝะธะตะผ

**ะะทะผะตะฝะตะฝะธั** ะฒ [bot/handlers/flow.py](../bot/handlers/flow.py):

```python
# ะะซะะ: ัะธะปััั ะฟะพ is_pricing_known
if not model.get("is_pricing_known", False):
    return False

# ะกะขะะะ: ะฟะพะบะฐะทัะฒะฐะตะผ ะฒัะต ะผะพะดะตะปะธ ั ัะตะฝะพะน
if model.get("price") is None:
    return False
```

**ะะตะทัะปััะฐั**:
- โ ะัะต 89 ะผะพะดะตะปะตะน ะดะพัััะฟะฝั ะฟะพะปัะทะพะฒะฐัะตะปัะผ
- โ๏ธ 66 ะผะพะดะตะปะตะน ะฟะพะบะฐะทัะฒะฐัั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต ะฒ ะบะฐััะพัะบะต:
  ```
  โ๏ธ ะฆะตะฝะฐ ะฟัะตะดะฒะฐัะธัะตะปัะฝะฐั, ะฐะบััะฐะปะธะทะธััะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ
  ```

### 2๏ธโฃ ะะะะะะะฌะะะ: ะกะธะฝััะพะฝะธะทะฐัะธั ั Kie.ai API

**ะกะบัะธะฟั**: [scripts/sync_kie_pricing.py](../scripts/sync_kie_pricing.py)

**ะคัะฝะบัะธะธ**:
1. ะะพะปััะฐะตั ะฐะบััะฐะปัะฝัะต ัะตะฝั ะธะท Kie.ai API
2. ะะฑะฝะพะฒะปัะตั `price` ะฒ source of truth
3. ะฃััะฐะฝะฐะฒะปะธะฒะฐะตั `is_pricing_known=True` ะดะปั ะฟะพะดัะฒะตัะถะดัะฝะฝัั
4. ะฃะดะฐะปัะตั `disabled_reason` ะฟัะธ ะฟะพะดัะฒะตัะถะดะตะฝะธะธ

**ะัะฟะพะปัะทะพะฒะฐะฝะธะต**:

```bash
# ะกััะพะน ะฟัะพะณะพะฝ (ะฑะตะท ัะพััะฐะฝะตะฝะธั)
python scripts/sync_kie_pricing.py --dry-run

# ะะตะฐะปัะฝะฐั ัะธะฝััะพะฝะธะทะฐัะธั
export KIE_API_KEY='your-key-here'
python scripts/sync_kie_pricing.py
```

**ะัะฒะพะด**:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
KIE.AI PRICING SYNC
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1. Loading source of truth...
   โ Loaded 107 models

2. Fetching models from Kie.ai API...
   โ Fetched 150 models from Kie.ai API

3. Syncing pricing...
  ๐ bytedance/seedream-v4-edit: $15.0 โ $12.0
  โ bytedance/seedream-v4-edit: ENABLED (price confirmed)
  ๐ flux/kontext: $12.0 โ $10.0
  โ flux/kontext: ENABLED (price confirmed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
SUMMARY:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  Prices updated:     25
  Prices confirmed:   66
  Models enabled:     66

โ Sync complete!
```

## ะะตะทัะปััะฐัั

### ะะพ ะธะทะผะตะฝะตะฝะธะน:
- โ ะะบัะธะฒะฝัั: 23 ะผะพะดะตะปะธ (25.8%)
- โ ะกะบััััั: 66 ะผะพะดะตะปะตะน (74.2%)

### ะะพัะปะต ะธะทะผะตะฝะตะฝะธะน:
- โ **ะะพัััะฟะฝั ะฒัะต 89 AI ะผะพะดะตะปะตะน (100%)**
- โ๏ธ 66 ั ะฟัะตะดัะฟัะตะถะดะตะฝะธะตะผ ะพ ะฟัะตะดะฒะฐัะธัะตะปัะฝะพะน ัะตะฝะต
- ๐ ะะฒัะพะผะฐัะธัะตัะบะฐั ัะธะฝััะพะฝะธะทะฐัะธั ัะตัะตะท API

## ะะฒัะพะผะฐัะธะทะฐัะธั

ะะพะฑะฐะฒะธัั ะฒ cron/GitHub Actions:

```yaml
# .github/workflows/sync-pricing.yml
name: Sync Kie.ai Pricing
on:
  schedule:
    - cron: '0 */6 * * *'  # ะะฐะถะดัะต 6 ัะฐัะพะฒ
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: '3.12'
      - run: pip install httpx
      - run: python scripts/sync_kie_pricing.py
        env:
          KIE_API_KEY: ${{ secrets.KIE_API_KEY }}
      - uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: '๐ Auto-sync pricing from Kie.ai API'
```

## ะะพะผะฐะฝะดั ะฟัะพะฒะตัะบะธ

```bash
# ะัะพะฒะตัะบะฐ ะพัะฒะฐัะฐ ะผะพะดะตะปะตะน
python scripts/audit_model_coverage.py
# ะะตะทัะปััะฐั: 89/107 (83.2%) - ะฒัะต AI ะผะพะดะตะปะธ

# ะัะพะฒะตัะบะฐ ะณะตะฝะตัะฐัะธะธ
python scripts/audit_model_smoke.py
# ะะตะทัะปััะฐั: 80/80 (100%) - ะฒัะต ัะฐะฑะพัะฐัั

# ะัะพะฒะตัะบะฐ ัะตะฝ
python scripts/audit_pricing.py
# ะะตะทัะปััะฐั: โ Formula verified, 5 FREE models
```

## ะกัะฐััั

โ **ะะะจะะะ**
- ะัะต 89 AI ะผะพะดะตะปะตะน ะดะพัััะฟะฝั
- ะัะตะดัะฟัะตะถะดะตะฝะธะต ะดะปั ะผะพะดะตะปะตะน ั ะฝะตะฟะพะดัะฒะตัะถะดัะฝะฝะพะน ัะตะฝะพะน
- ะะฒัะพะผะฐัะธัะตัะบะฐั ัะธะฝััะพะฝะธะทะฐัะธั ัะตัะตะท API
- ะัะพะทัะฐัะฝะพััั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั

**Commit**: `[pending]`
