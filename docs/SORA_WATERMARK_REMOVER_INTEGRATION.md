# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è sora-watermark-remover

## üìã –û–±–∑–æ—Ä

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ `sora-watermark-remover` —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ KIE AI API.

## üîó API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **URL —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏**: `POST https://api.kie.ai/api/v1/jobs/createTask`
- **URL —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏**: `GET https://api.kie.ai/api/v1/jobs/recordInfo?taskId={taskId}`
- **–ú–æ–¥–µ–ª—å**: `sora-watermark-remover`

## üìù –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è |
|----------|-----|----------|-------------|
| `model` | string | ID –º–æ–¥–µ–ª–∏ | `"sora-watermark-remover"` |
| `input.video_url` | string | –ü—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ Sora 2 | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π, –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `sora.chatgpt.com`, –º–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤ |

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|-----|----------|----------------------|
| `callBackUrl` | string | URL –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ | –ù–µ —É–∫–∞–∑–∞–Ω (–Ω–µ—Ç callback) |

### –î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

#### `video_url`
- **–¢–∏–ø**: string
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π**: –¥–∞
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ Sora 2 –æ—Ç OpenAI
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**:
  - –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `sora.chatgpt.com` (https:// –∏–ª–∏ http://)
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 500 —Å–∏–º–≤–æ–ª–æ–≤
  - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º
- **Default**: `"https://sora.chatgpt.com/p/s_68e83bd7eee88191be79d2ba7158516f"`
- **–ü—Ä–∏–º–µ—Ä—ã**:
  - ‚úÖ `https://sora.chatgpt.com/p/s_68e83bd7eee88191be79d2ba7158516f`
  - ‚úÖ `http://sora.chatgpt.com/p/s_abc123def456`
  - ‚ùå `https://example.com/video.mp4` (–Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å sora.chatgpt.com)
  - ‚ùå `sora.chatgpt.com/p/s_abc123` (–Ω–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª–∞)

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è

–§—É–Ω–∫—Ü–∏—è `_validate_sora_watermark_remover()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:

1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å `video_url`**: –ü–æ–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–∫–∞–∑–∞–Ω–æ
2. **–§–æ—Ä–º–∞—Ç URL**: –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `sora.chatgpt.com`
3. **–î–ª–∏–Ω–∞ URL**: –ú–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤
4. **–ü—Ä–æ—Ç–æ–∫–æ–ª**: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å `https://` –∏–ª–∏ `http://`

### –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è

–§—É–Ω–∫—Ü–∏—è `_normalize_video_url_for_sora_watermark_remover()`:

1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫—É
2. –£–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã (trim)
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–ª–∏–Ω—É (–º–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤)
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ URL –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sora.chatgpt.com`
5. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π URL –∏–ª–∏ `None` –µ—Å–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π

### –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

–ï—Å–ª–∏ `video_url` –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```python
"https://sora.chatgpt.com/p/s_68e83bd7eee88191be79d2ba7158516f"
```

## üìä –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ó–∞–ø—Ä–æ—Å

```json
{
  "model": "sora-watermark-remover",
  "input": {
    "video_url": "https://sora.chatgpt.com/p/s_68e83bd7eee88191be79d2ba7158516f"
  }
}
```

### –û—Ç–≤–µ—Ç

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "taskId": "281e5b0*********************f39b9"
  }
}
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢–æ–ª—å–∫–æ –≤–∏–¥–µ–æ Sora 2**: –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –≤–∏–¥–µ–æ, —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ OpenAI Sora 2
2. **–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø**: –í–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º (–Ω–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º)
3. **–§–æ—Ä–º–∞—Ç URL**: URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–º–µ–Ω–Ω–æ –æ—Ç OpenAI (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sora.chatgpt.com`)
4. **–î–ª–∏–Ω–∞ URL**: –ú–∞–∫—Å–∏–º—É–º 500 —Å–∏–º–≤–æ–ª–æ–≤

## üö® –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `–ü–æ–ª–µ 'video_url' –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ...` | `video_url` –Ω–µ —É–∫–∞–∑–∞–Ω | –£–∫–∞–∂–∏—Ç–µ –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –≤–∏–¥–µ–æ Sora 2 |
| `–ü–æ–ª–µ 'video_url' —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ...` | URL –±–æ–ª—å—à–µ 500 —Å–∏–º–≤–æ–ª–æ–≤ | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–π URL |
| `–ü–æ–ª–µ 'video_url' –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ–π —Å—Å—ã–ª–∫–æ–π...` | URL –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sora.chatgpt.com` | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Å—ã–ª–∫—É –æ—Ç OpenAI Sora 2 |

## üìù –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∫–æ–¥

–ú–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `build_input()`:

```python
from app.services.kie_input_builder import build_input
from app.kie_catalog import get_model

model_spec = get_model("sora-watermark-remover")
user_payload = {
    "video_url": "https://sora.chatgpt.com/p/s_68e83bd7eee88191be79d2ba7158516f"
}

input_dict, error = build_input(model_spec, user_payload)
if error:
    print(f"–û—à–∏–±–∫–∞: {error}")
else:
    print(f"Input: {input_dict}")
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ `watermark_remove` —Å –ø–æ–ª–µ–º `video_url`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_normalize_video_url_for_sora_watermark_remover()`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `_validate_sora_watermark_remover()`
- [x] –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ `build_input()`
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

