# –†–ï–ï–°–¢–† –†–ò–°–ö–û–í –ò –ë–ê–ì–û–í

**–î–∞—Ç–∞:** 2025-12-21  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üìä –¢–ê–ë–õ–ò–¶–ê –†–ò–°–ö–û–í

| Issue | –ì–¥–µ –≤ –∫–æ–¥–µ | –°–∏–º–ø—Ç–æ–º—ã –Ω–∞ Render | Severity | Fix Strategy | Verification |
|-------|------------|-------------------|----------|--------------|--------------|
| **P0-1: –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ async** | `bot_kie.py:679,697,756,794,925,1473,1553,1771` - `open()` –±–µ–∑ executor | –ó–∞–≤–∏—Å–∞–Ω–∏—è, —Ç–∞–π–º–∞—É—Ç—ã, SIGTERM –ø—Ä–∏ –¥–µ–ø–ª–æ–µ | **P0** | –û–±–µ—Ä–Ω—É—Ç—å –≤—Å–µ `open()` –≤ `asyncio.to_thread()` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `aiofiles` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö `open()` –≤ async —Ñ—É–Ω–∫—Ü–∏—è—Ö |
| **P0-2: PIL/OCR –±–µ–∑ executor** | `bot_kie.py:2030,2034,2039,2041` - `Image.open()`, `pytesseract.image_to_string()` | –ó–∞–≤–∏—Å–∞–Ω–∏—è –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–ª–∞—Ç–µ–∂–µ–π | **P0** | –û–±–µ—Ä–Ω—É—Ç—å –≤ `asyncio.to_thread()` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ OCR –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç event loop |
| **P0-3: –£–ø–æ–º–∏–Ω–∞–Ω–∏—è "KIE" –≤ UI** | `bot_kie.py:2,3,25,26,32,33,2231,2233,2243,2245,2252,2543,2545,2857` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –ª–æ–≥–∏ | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã | **P0** | –£–±—Ä–∞—Ç—å –≤—Å–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è "KIE" –∏–∑ user-facing —Ç–µ–∫—Å—Ç–æ–≤ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ—Ç "KIE" |
| **P0-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ query.answer()** | `bot_kie.py` - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ callback handlers | –ö–Ω–æ–ø–∫–∏ "–≤–∏—Å—è—Ç", –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç feedback | **P0** | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ callback handlers, –¥–æ–±–∞–≤–∏—Ç—å `await query.answer()` | –°–∫—Ä–∏–ø—Ç `scan_callbacks.py` –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ |
| **P0-5: –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞—Ä–∏ –±–µ–∑ locks** | `bot_kie.py:312,316,320,570` - `user_sessions`, `active_generations`, `_data_cache` | Race conditions, –ø–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö | **P0** | –î–æ–±–∞–≤–∏—Ç—å `asyncio.Lock()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ —Å–ª–æ–≤–∞—Ä—è–º–∏ –∑–∞—â–∏—â–µ–Ω—ã |
| **P1-1: –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã** | `helpers.py:45-100` - –ª–µ–Ω–∏–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Ü–∏–∫–ª–æ–≤ | –ó–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ, ImportError | **P1** | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–º–ø–æ—Ä—Ç–æ–≤ | `scan_imports.py` –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ —Ü–∏–∫–ª—ã |
| **P1-2: –¢—è–∂–µ–ª—ã–µ –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ** | `bot_kie.py:23-35` - –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª—è | –ú–µ–¥–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç –Ω–∞ Render | **P1** | –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (—É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–æ) | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∏–º–ø–æ—Ä—Ç–∞ `bot_kie.py` |
| **P1-3: –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö handlers** | `bot_kie.py` - –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ try/except | –ü–∞–¥–µ–Ω–∏—è –±–æ—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö | **P1** | –î–æ–±–∞–≤–∏—Ç—å try/except –≤–æ –≤—Å–µ handlers | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ handlers –∏–º–µ—é—Ç error handling |
| **P1-4: –°–µ—Å—Å–∏–∏ –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è** | `bot_kie.py` - `user_sessions` –º–æ–∂–µ—Ç —Ä–∞—Å—Ç–∏ | –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ | **P1** | –î–æ–±–∞–≤–∏—Ç—å TTL –¥–ª—è —Å–µ—Å—Å–∏–π, –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Å—Å–∏–∏ –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ `ConversationHandler.END` |
| **P1-5: –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π** | `input_parameters()` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã | –û—à–∏–±–∫–∏ –≤ KIE API, –ø–æ—Ç–µ—Ä—è –±–∞–ª–∞–Ω—Å–∞ | **P1** | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `app/domain/models_registry.py` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è |
| **P2-1: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π bot_kie.py** | `bot_kie.py` - ~26,000 —Å—Ç—Ä–æ–∫ | –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ | **P2** | –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤ `app/` –º–æ–¥—É–ª–∏ | –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä `bot_kie.py` |
| **P2-2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞ - –ø–æ—Ö–æ–∂–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ | –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ | **P2** | –í—ã–Ω–µ—Å—Ç–∏ –æ–±—â—É—é –ª–æ–≥–∏–∫—É –≤ services | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ |
| **P2-3: –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤** | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç unit/integration —Ç–µ—Å—Ç—ã | –†–µ–≥—Ä–µ—Å—Å–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö | **P2** | –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π | `verify_project.py` —Ä–∞—Å—à–∏—Ä–∏—Ç—å —Ç–µ—Å—Ç–∞–º–∏ |
| **P2-4: –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏/–∞–ª–µ—Ä—Ç—ã | –ü—Ä–æ–±–ª–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è –ø–æ–∑–¥–Ω–æ | **P2** | –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ (uptime, errors, generations) | Healthcheck —Ä–∞—Å—à–∏—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∞–º–∏ |

---

## üî¥ P0 - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)

### P0-1: –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ async

**–§–∞–π–ª—ã:**
- `bot_kie.py:679` - `with open(filename, 'r', encoding='utf-8') as f:`
- `bot_kie.py:697` - `with open(filename, 'w', encoding='utf-8') as f:`
- `bot_kie.py:756` - `with open(temp_filename, 'w', encoding='utf-8') as f:`
- `bot_kie.py:794` - `with open(filename, 'w', encoding='utf-8') as f:`
- `bot_kie.py:925` - `with open(BALANCES_FILE, 'w', encoding='utf-8') as f:`
- `bot_kie.py:1473` - `with open(GENERATIONS_HISTORY_FILE, 'w', encoding='utf-8') as f:`
- `bot_kie.py:1553` - `with open(GENERATIONS_HISTORY_FILE, 'w', encoding='utf-8') as f:`
- `bot_kie.py:1771` - `with open(PAYMENTS_FILE, 'w', encoding='utf-8') as f:`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í—Å–µ —ç—Ç–∏ `open()` –±–ª–æ–∫–∏—Ä—É—é—Ç event loop
- –ú–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –∑–∞–≤–∏—Å–∞–Ω–∏—è –Ω–∞ Render

**Fix Strategy:**
- –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `aiofiles.open()` –∏–ª–∏ –æ–±–µ—Ä–Ω—É—Ç—å –≤ `asyncio.to_thread()`
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `app/storage/json_storage.py` –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `aiofiles`

**Verification:**
- `scan_blocking.py` –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –≤—Å–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ `open()`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ async

---

### P0-2: PIL/OCR –±–µ–∑ executor

**–§–∞–π–ª—ã:**
- `bot_kie.py:2030` - `image = Image.open(BytesIO(image_data))`
- `bot_kie.py:2034` - `extracted_text = pytesseract.image_to_string(image, lang='rus+eng')`
- `bot_kie.py:2039` - `extracted_text = pytesseract.image_to_string(image, lang='eng')`
- `bot_kie.py:2041` - `extracted_text = pytesseract.image_to_string(image)`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `Image.open()` –∏ `pytesseract.image_to_string()` –±–ª–æ–∫–∏—Ä—É—é—Ç event loop
- –ú–æ–≥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å –∑–∞–≤–∏—Å–∞–Ω–∏—è –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–ª–∞—Ç–µ–∂–µ–π

**Fix Strategy:**
- –û–±–µ—Ä–Ω—É—Ç—å –≤ `asyncio.to_thread()`:
```python
image = await asyncio.to_thread(Image.open, BytesIO(image_data))
extracted_text = await asyncio.to_thread(pytesseract.image_to_string, image, lang='rus+eng')
```

**Verification:**
- `scan_blocking.py` –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –≤—Å–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ PIL/OCR –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ OCR –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç event loop

---

### P0-3: –£–ø–æ–º–∏–Ω–∞–Ω–∏—è "KIE" –≤ UI

**–§–∞–π–ª—ã:**
- `bot_kie.py:2,3` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- `bot_kie.py:2231,2233,2243,2245,2252` - TODO –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å user-facing —Ç–µ–∫—Å—Ç—ã

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã "KIE"

**Fix Strategy:**
- –ù–∞–π—Ç–∏ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (—á–µ—Ä–µ–∑ `t()` –∏–ª–∏ –ø—Ä—è–º—ã–µ —Å—Ç—Ä–æ–∫–∏)
- –ó–∞–º–µ–Ω–∏—Ç—å "KIE" –Ω–∞ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã ("AI", "–≥–µ–Ω–µ—Ä–∞—Ü–∏—è", "–º–æ–¥–µ–ª—å")

**Verification:**
- `grep -r "KIE" bot_kie.py | grep -v "#" | grep -v "TODO"` - –Ω–∞–π—Ç–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ –∫–æ–¥–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ—Ç "KIE"

---

### P0-4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ query.answer()

**–§–∞–π–ª—ã:**
- `bot_kie.py:2739` - `button_callback()` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ callback handlers

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ `query.answer()` –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–Ω–æ–ø–∫–∞ "–≤–∏—Å–∏—Ç"
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç feedback

**Fix Strategy:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ callback handlers
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `await query.answer()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ –∫–∞–∂–¥–æ–≥–æ handler

**Verification:**
- `scan_callbacks.py` –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –≤—Å–µ callback handlers –±–µ–∑ `query.answer()`

---

### P0-5: –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞—Ä–∏ –±–µ–∑ locks

**–§–∞–π–ª—ã:**
- `bot_kie.py:312` - `user_sessions = {}`
- `bot_kie.py:316` - `active_generations = {}` (–µ—Å—Ç—å `active_generations_lock`)
- `bot_kie.py:320` - `saved_generations = {}`
- `bot_kie.py:570` - `_data_cache = {}`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `user_sessions` –∏ `saved_generations` –Ω–µ –∑–∞—â–∏—â–µ–Ω—ã locks
- `_data_cache` –Ω–µ –∑–∞—â–∏—â–µ–Ω lock
- Race conditions –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ

**Fix Strategy:**
- –î–æ–±–∞–≤–∏—Ç—å `asyncio.Lock()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Å–ª–æ–≤–∞—Ä—è–º–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `async with lock:`

**Verification:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ —Å–ª–æ–≤–∞—Ä—è–º–∏ –∑–∞—â–∏—â–µ–Ω—ã locks

---

## üü° P1 - –í–ê–ñ–ù–´–ï (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)

### P1-1: –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã

**–§–∞–π–ª—ã:**
- `helpers.py:45-100` - –ª–µ–Ω–∏–≤—ã–µ –∏–º–ø–æ—Ä—Ç—ã –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Ü–∏–∫–ª–æ–≤
- `bot_kie.py` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑ `helpers.py`
- `helpers.py` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏–∑ `app/services/user_service.py`
- `app/services/user_service.py` –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `bot_kie.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°–ª–æ–∂–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–º–ø–æ—Ä—Ç–æ–≤
- –ú–æ–≥—É—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç—ã–µ —Ü–∏–∫–ª—ã

**Fix Strategy:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `scan_imports.py` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ü–∏–∫–ª–æ–≤
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–º–ø–æ—Ä—Ç–æ–≤

**Verification:**
- `scan_imports.py` –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –≤—Å–µ —Ü–∏–∫–ª—ã

---

### P1-2: –¢—è–∂–µ–ª—ã–µ –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–§–∞–π–ª—ã:**
- `bot_kie.py:23-35` - –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª—è
- `bot_kie.py:67-119` - –∏–º–ø–æ—Ä—Ç—ã PIL/OCR (—É–∂–µ –ª–µ–Ω–∏–≤—ã–µ)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò–º–ø–æ—Ä—Ç `bot_kie.py` –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º
- –ó–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –Ω–∞ Render

**Fix Strategy:**
- –õ–µ–Ω–∏–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (—á–∞—Å—Ç–∏—á–Ω–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)
- –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ç—è–∂–µ–ª—ã–µ –∏–º–ø–æ—Ä—Ç—ã –≤ —Ñ—É–Ω–∫—Ü–∏–∏

**Verification:**
- –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∏–º–ø–æ—Ä—Ç–∞ `bot_kie.py`

---

### P1-3: –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–§–∞–π–ª—ã:**
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ handlers –≤ `bot_kie.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ handlers –º–æ–≥—É—Ç –ø–∞–¥–∞—Ç—å –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**Fix Strategy:**
- –î–æ–±–∞–≤–∏—Ç—å try/except –≤–æ –≤—Å–µ handlers
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å global error handler –∫–∞–∫ fallback

**Verification:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ handlers –∏–º–µ—é—Ç error handling

---

### P1-4: –°–µ—Å—Å–∏–∏ –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è

**–§–∞–π–ª—ã:**
- `bot_kie.py:312` - `user_sessions = {}`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°–µ—Å—Å–∏–∏ –º–æ–≥—É—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è
- –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏

**Fix Strategy:**
- –î–æ–±–∞–≤–∏—Ç—å TTL –¥–ª—è —Å–µ—Å—Å–∏–π
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ `ConversationHandler.END`

**Verification:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Å—Å–∏–∏ –æ—á–∏—â–∞—é—Ç—Å—è

---

### P1-5: –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–§–∞–π–ª—ã:**
- `input_parameters()` - —Å–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ KIE API

**Fix Strategy:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `app/domain/models_registry.py` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º –∫–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**Verification:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è

---

## üü¢ P2 - –ñ–ï–õ–ê–¢–ï–õ–¨–ù–´–ï (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)

### P2-1: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π bot_kie.py

**–§–∞–π–ª:**
- `bot_kie.py` - ~26,000 —Å—Ç—Ä–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**Fix Strategy:**
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –≤ `app/` –º–æ–¥—É–ª–∏
- –í—ã–Ω–µ—Å—Ç–∏ handlers –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
- –í—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ services

**Verification:**
- –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä `bot_kie.py` –¥–æ <10,000 —Å—Ç—Ä–æ–∫

---

### P2-2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ—Ö–æ–∂–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö

**Fix Strategy:**
- –í—ã–Ω–µ—Å—Ç–∏ –æ–±—â—É—é –ª–æ–≥–∏–∫—É –≤ services/helpers

**Verification:**
- –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –Ω–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

---

### P2-3: –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç unit/integration —Ç–µ—Å—Ç—ã

**Fix Strategy:**
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –†–∞—Å—à–∏—Ä–∏—Ç—å `verify_project.py`

**Verification:**
- –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ >50%

---

### P2-4: –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏/–∞–ª–µ—Ä—Ç—ã

**Fix Strategy:**
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ healthcheck
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫

**Verification:**
- Healthcheck –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏

---

## üìù –ü–†–ò–ú–ï–ß–ê–ù–ò–Ø

- **Severity:**
  - P0 - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, –±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—É –Ω–∞ Render
  - P1 - –í–∞–∂–Ω—ã–µ, –≤–ª–∏—è—é—Ç –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å/UX
  - P2 - –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ, —É–ª—É—á—à–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞

- **Verification:**
  - –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å `python scripts/verify_project.py`
  - –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è P0 - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ Render

