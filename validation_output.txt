INFO:app.kie.generator:[corr=none] [GENERATOR] Starting generate for model=z-image
INFO:app.kie.generator:[corr=none] [GENERATOR]   - user_inputs keys: ['prompt', 'aspect_ratio']
INFO:app.kie.builder:âœ… Loading SOURCE_OF_TRUTH v1.2.0 (cached): models/KIE_SOURCE_OF_TRUTH.json
INFO:app.kie.generator:[corr=none] [GENERATOR] âœ… Input validation passed for z-image
INFO:app.kie.router:âœ… Loading SOURCE_OF_TRUTH (cached): /workspaces/TRT/models/KIE_SOURCE_OF_TRUTH.json
INFO:app.kie.generator:Using V4 API for model z-image
INFO:app.kie.generator:  - user_inputs to build_category_payload: {'prompt': 'A beautiful sunset over mountains', 'aspect_ratio': '16:9'}
INFO:app.kie.generator:  - user_inputs keys: ['prompt', 'aspect_ratio']
INFO:app.kie.router:Built image payload for z-image: ['model', 'callBackUrl', 'input']
INFO:app.kie.generator:  - payload built: {'model': 'z-image', 'callBackUrl': '', 'input': {'prompt': 'A beautiful sunset over mountains', 'aspect_ratio': '16:9'}}
INFO:app.kie.generator:Create task response: {'taskId': 'stub_task_z-image', 'status': 'waiting'}
INFO:app.storage.factory:[OK] Using JSON storage (AUTO mode, data_dir=./data)
INFO:app.kie.generator:âœ… JOB CREATED | TaskID: stub_task_z-image | User: 1 | Chat: 1
INFO:app.kie.generator:â³ POLLING | TaskID: stub_task_z-image | Timeout: 1s | Interval: 2s
INFO:app.kie.generator:[corr=none] [GENERATOR] Starting generate for model=z-image
INFO:app.kie.generator:[corr=none] [GENERATOR]   - user_inputs keys: ['prompt']
ERROR:app.kie.generator:[corr=none] [GENERATOR] Input validation failed for z-image:
  â€¢ Missing required field: aspect_ratio
INFO:app.kie.generator:[corr=none] [GENERATOR] Starting generate for model=z-image
INFO:app.kie.generator:[corr=none] [GENERATOR]   - user_inputs keys: ['prompt', 'aspect_ratio']
ERROR:app.kie.generator:[corr=none] [GENERATOR] Input validation failed for z-image:
  â€¢ Invalid value for aspect_ratio: 32:9. Must be one of: 1:1, 16:9, 9:16, 4:3, 3:4, 21:9, 9:21
INFO:app.kie.generator:[corr=none] [GENERATOR] Starting generate for model=nonexistent-model-xyz
INFO:app.kie.generator:[corr=none] [GENERATOR]   - user_inputs keys: ['prompt']
ERROR:app.kie.generator:[corr=none] [GENERATOR] Input validation failed for nonexistent-model-xyz:
  â€¢ Unknown model: nonexistent-model-xyz

ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§
INPUT VALIDATION INTEGRATION TESTS
Testing: generator.py validation layer
Mode: DRY RUN (KIE_STUB=true)
ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§ğŸ”§

================================================================================
TEST 1: Valid inputs should pass
================================================================================

âœ… Result: False
   Message: â±ï¸ ĞŸÑ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ (1 ÑĞµĞº)

âœ… Test passed: Valid inputs accepted

================================================================================
TEST 2: Missing required field should fail
================================================================================

âŒ Result: False
   Message: âŒ ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğµ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
  â€¢ Missing required field: aspect_ratio
   Error: VALIDATION_ERROR

âœ… Test passed: Missing required field detected

================================================================================
TEST 3: Invalid enum value should fail
================================================================================

âŒ Result: False
   Message: âŒ ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğµ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
  â€¢ Invalid value for aspect_ratio: 32:9. Must be one of: 1:1, 16:9, 9:16, 4:3, 3:4, 21:9, 9:21
   Error: VALIDATION_ERROR

âœ… Test passed: Invalid enum value detected

================================================================================
TEST 4: Unknown model should fail
================================================================================

âŒ Result: False
   Message: âŒ ĞĞµĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğµ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ:
  â€¢ Unknown model: nonexistent-model-xyz
   Error: VALIDATION_ERROR

âœ… Test passed: Unknown model detected

âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…
ALL VALIDATION TESTS PASSED
âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…âœ…

Integration complete:
  âœ… Valid inputs pass through
  âœ… Missing required fields rejected
  âœ… Invalid enum values rejected
  âœ… Unknown models rejected

ğŸ¯ PHASE B COMPLETE: Validation integrated into generator.py
