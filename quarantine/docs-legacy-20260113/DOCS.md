# –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è KIE.ai Market

## –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 2025-12-18

---

## üìã –°–ü–ò–°–û–ö –ú–û–î–ï–õ–ï–ô –ò MODES

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```json
{
  "model_id": "string",
  "title": "string",
  "provider": "string",
  "description": "string",
  "category": "Image|Video|Audio|Music|Tools",
  "modes": {
    "<mode_key>": {
      "api_model": "string",
      "generation_type": "text_to_image | text_to_video | ...",
      "input_schema": {...},
      "pricing": {
        "credits": number,
        "credit_to_rub_rate": number,
        "markup": 2
      },
      "help": "string"
    }
  }
}
```

### –¢–∏–ø—ã generation_type

- `text_to_image` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—Å—Ç–∞
- `image_to_image` - –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `text_to_video` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞
- `image_to_video` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `video_to_video` - –ê–Ω–∏–º–∞—Ü–∏—è –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ
- `image_edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `image_upscale` - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `video_edit` - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ
- `speech_to_video` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∏–¥–µ–æ –∏–∑ —Ä–µ—á–∏
- `text_to_speech` - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Ä–µ—á—å
- `speech_to_text` - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—á–∏ –≤ —Ç–µ–∫—Å—Ç
- `music_generation` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º—É–∑—ã–∫–∏
- `audio_to_audio` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ

---

## üîÑ API FLOW

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

```python
POST /api/v1/jobs/createTask
{
  "model": "<api_model_string>",
  "input": {
    "prompt": "...",
    "duration": 5,
    ...
  },
  "callBackUrl": "<optional>"
}

Response:
{
  "code": 200,
  "data": {
    "taskId": "..."
  }
}
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

```python
GET /api/v1/jobs/recordInfo?taskId=<task_id>

Response:
{
  "code": 200,
  "data": {
    "taskId": "...",
    "state": "waiting|queuing|generating|success|fail",
    "resultJson": "{...}",
    "failCode": "...",
    "failMsg": "..."
  }
}
```

### 3. –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ò–∑ `resultJson` –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è `resultUrls` - –º–∞—Å—Å–∏–≤ URL —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## üí∞ PRICING RULES

### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã

```
price_rub = round(credits * credit_to_rub_rate * markup)
```

–ì–¥–µ:
- `credits` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–µ–¥–∏—Ç–æ–≤ KIE AI
- `credit_to_rub_rate` - –∞–¥–º–∏–Ω—Å–∫–∏–π –∫—É—Ä—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.1)
- `markup` - –º–∞—Ä–∂–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2.0)

### –ù–∞—Ü–µ–Ω–∫–∏ –∑–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:** 1080p/4k = +30% –∫ –±–∞–∑–æ–≤–æ–π —Ü–µ–Ω–µ
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –ö–∞–∂–¥—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ 5 —Å–µ–∫—É–Ω–¥ = +10%
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:** –ö–∞–∂–¥–æ–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ = 80% –æ—Ç –±–∞–∑–æ–≤–æ–π
- **–£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞:** +50%

### –ü–æ–∫–∞–∑ —Ü–µ–Ω—ã

–¶–µ–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é **–î–û** –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

---

## üé® UX FLOW

### –ü–æ–ª–Ω—ã–π —Ñ–ª–æ—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```
–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
  ‚Üì
–ö–∞—Ç–µ–≥–æ—Ä–∏—è (Image/Video/Audio/Music/Tools)
  ‚Üì
–ú–æ–¥–µ–ª—å (–≤—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
  ‚Üì
Mode (text_to_image, image_to_video –∏ —Ç.–¥.)
  ‚Üì
–í–≤–æ–¥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–ø–æ—à–∞–≥–æ–≤–æ)
  - prompt (—Ç–µ–∫—Å—Ç)
  - duration (–¥–ª—è –≤–∏–¥–µ–æ)
  - resolution (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ)
  - aspect_ratio (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω)
  - –∏ —Ç.–¥.
  ‚Üì
–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ü–µ–Ω—ã
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç–∏
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –Ω–∞—á–∞—Ç—å"
  ‚Üì
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è
  - –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ API
  - Polling —Å—Ç–∞—Ç—É—Å–∞
  ‚Üì
–°—Ç–∞—Ç—É—Å
  - waiting ‚Üí queuing ‚Üí generating ‚Üí success/fail
  - –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
  ‚Üì
–†–µ–∑—É–ª—å—Ç–∞—Ç
  - –£—Å–ø–µ—Ö: –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è resultUrls
  - –û—à–∏–±–∫–∞: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```

### Tooltip-–ø–æ–º–æ—â—å

–ü—Ä–∏ –≤—ã–±–æ—Ä–µ mode –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
- –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç mode
- –ö–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω—É–∂–Ω—ã
- –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å duration/resolution

---

## üîß TEST_MODE / DRY_RUN

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ TEST_MODE

- ‚ùå **–ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è** —Ä–µ–∞–ª—å–Ω—ã–π KIE API
- ‚ùå **–ù–ï —Å–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è** –±–∞–ª–∞–Ω—Å
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **MockKieGateway**
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è **—Ñ–µ–π–∫–æ–≤—ã–µ resultUrls**
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ **"DRY RUN"**

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞

```python
from config_runtime import is_dry_run, is_test_mode

if is_dry_run() or is_test_mode():
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock
    pass
```

---

## üìä ANALYTICS

### –ú–µ—Ç—Ä–∏–∫–∏

–î–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏/mode –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è:
- `total_requests` - –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- `success` - –£—Å–ø–µ—à–Ω—ã—Ö
- `fail` - –û—à–∏–±–æ–∫
- `avg_latency` - –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞
- `min_latency` - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- `max_latency` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

### –û—Ç—á—ë—Ç

```python
from analytics_monitoring import get_analytics_report

report = get_analytics_report()
```

---

## üß™ –¢–ï–°–¢–´

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
make test
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
- ‚úÖ Valid cases –¥–ª—è –∫–∞–∂–¥–æ–≥–æ mode
- ‚úÖ Invalid input
- ‚úÖ Test mode mock
- ‚úÖ Pricing calculation
- ‚úÖ Callback + polling

---

## üìù –ò–ù–°–¢–†–£–ö–¶–ò–ò

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å `python scripts/deep_analyze_kie_models.py`
2. –ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏–∑ API
3. –î–æ–±–∞–≤–∏—Ç—å –≤ `master_catalogue.json`
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å `python scripts/sync_kie_models.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π

```bash
python scripts/sync_kie_models.py
```

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç –æ—Ç—á—ë—Ç –æ:
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª—è—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö modes
- –ü—Ä–æ–±–ª–µ–º–∞—Ö —Å input_schema

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π gateway** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
2. **–í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
3. **–í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ü–µ–Ω—É** –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
4. **–í TEST_MODE –Ω–µ —Å–ø–∏—Å—ã–≤–∞–π—Ç–µ –±–∞–ª–∞–Ω—Å**
5. **–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤—Å–µ –æ—à–∏–±–∫–∏** —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º

